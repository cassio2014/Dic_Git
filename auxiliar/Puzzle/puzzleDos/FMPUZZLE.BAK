Version 1.00
BEGIN Form Fmpuzzle
	AutoRedraw   = 0
	BackColor    = QBColor(7)
	BorderStyle  = 1
	Caption      = "PUZZLE"
	ControlBox   = -1
	Enabled      = -1
	ForeColor    = QBColor(0)
	Height       = Char(19)
	Left         = Char(23)
	MaxButton    = 0
	MinButton    = -1
	MousePointer = 0
	Tag          = ""
	Top          = Char(2)
	Visible      = -1
	Width        = Char(24)
	WindowState  = 0
	BEGIN Frame Frame
		BackColor    = QBColor(7)
		Caption      = ""
		DragMode     = 0
		Enabled      = -1
		ForeColor    = QBColor(0)
		Height       = Char(14)
		Left         = Char(0)
		MousePointer = 0
		TabIndex     = 0
		Tag          = ""
		Top          = Char(0)
		Visible      = -1
		Width        = Char(22)
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 2
			Caption      = "B"
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 1
			Left         = Char(5)
			MousePointer = 0
			TabIndex     = 2
			Tag          = ""
			Top          = Char(0)
			Visible      = -1
			Width        = Char(5)
		END
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 2
			Caption      = "C"
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 2
			Left         = Char(10)
			MousePointer = 0
			TabIndex     = 3
			Tag          = ""
			Top          = Char(0)
			Visible      = -1
			Width        = Char(5)
		END
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 2
			Caption      = "D"
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 3
			Left         = Char(15)
			MousePointer = 0
			TabIndex     = 4
			Tag          = ""
			Top          = Char(0)
			Visible      = -1
			Width        = Char(5)
		END
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 2
			Caption      = "E"
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 4
			Left         = Char(0)
			MousePointer = 0
			TabIndex     = 5
			Tag          = ""
			Top          = Char(3)
			Visible      = -1
			Width        = Char(5)
		END
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 2
			Caption      = "F"
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 5
			Left         = Char(5)
			MousePointer = 0
			TabIndex     = 6
			Tag          = ""
			Top          = Char(3)
			Visible      = -1
			Width        = Char(5)
		END
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 2
			Caption      = "G"
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 6
			Left         = Char(10)
			MousePointer = 0
			TabIndex     = 7
			Tag          = ""
			Top          = Char(3)
			Visible      = -1
			Width        = Char(5)
		END
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 2
			Caption      = "H"
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 7
			Left         = Char(15)
			MousePointer = 0
			TabIndex     = 8
			Tag          = ""
			Top          = Char(3)
			Visible      = -1
			Width        = Char(5)
		END
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 2
			Caption      = "I"
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 8
			Left         = Char(0)
			MousePointer = 0
			TabIndex     = 9
			Tag          = ""
			Top          = Char(6)
			Visible      = -1
			Width        = Char(5)
		END
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 2
			Caption      = "J"
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 9
			Left         = Char(5)
			MousePointer = 0
			TabIndex     = 10
			Tag          = ""
			Top          = Char(6)
			Visible      = -1
			Width        = Char(5)
		END
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 2
			Caption      = "K"
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 10
			Left         = Char(10)
			MousePointer = 0
			TabIndex     = 11
			Tag          = ""
			Top          = Char(6)
			Visible      = -1
			Width        = Char(5)
		END
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 2
			Caption      = "L"
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 11
			Left         = Char(15)
			MousePointer = 0
			TabIndex     = 12
			Tag          = ""
			Top          = Char(6)
			Visible      = -1
			Width        = Char(5)
		END
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 2
			Caption      = "M"
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 12
			Left         = Char(0)
			MousePointer = 0
			TabIndex     = 13
			Tag          = ""
			Top          = Char(9)
			Visible      = -1
			Width        = Char(5)
		END
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 2
			Caption      = "N"
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 13
			Left         = Char(5)
			MousePointer = 0
			TabIndex     = 14
			Tag          = ""
			Top          = Char(9)
			Visible      = -1
			Width        = Char(5)
		END
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 2
			Caption      = "A"
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 0
			Left         = Char(0)
			MousePointer = 0
			TabIndex     = 1
			Tag          = ""
			Top          = Char(0)
			Visible      = -1
			Width        = Char(5)
		END
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 2
			Caption      = "O"
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 14
			Left         = Char(10)
			MousePointer = 0
			TabIndex     = 15
			Tag          = ""
			Top          = Char(9)
			Visible      = -1
			Width        = Char(5)
		END
		BEGIN Label Botao
			Alignment    = 2
			AutoSize     = 0
			BackColor    = QBColor(7)
			BorderStyle  = 1
			Caption      = " "
			DragMode     = 0
			Enabled      = -1
			ForeColor    = QBColor(0)
			Height       = Char(3)
			Index        = 15
			Left         = Char(15)
			MousePointer = 0
			TabIndex     = 16
			Tag          = ""
			Top          = Char(9)
			Visible      = -1
			Width        = Char(5)
		END
	END
	BEGIN Label Ltotck
		Alignment    = 2
		AutoSize     = 0
		BackColor    = QBColor(7)
		BorderStyle  = 2
		Caption      = "0"
		DragMode     = 0
		Enabled      = -1
		ForeColor    = QBColor(1)
		Height       = Char(3)
		Left         = Char(1)
		MousePointer = 0
		TabIndex     = 18
		Tag          = ""
		Top          = Char(14)
		Visible      = -1
		Width        = Char(6)
	END
	BEGIN CommandButton btmMistura
		BackColor    = QBColor(7)
		Cancel       = 0
		Caption      = "Misturar"
		Default      = 0
		DragMode     = 0
		Enabled      = -1
		Height       = Char(3)
		Left         = Char(7)
		MousePointer = 0
		TabIndex     = 17
		TabStop      = -1
		Tag          = ""
		Top          = Char(14)
		Visible      = -1
		Width        = Char(15)
	END
	BEGIN Menu btmarq
		Caption      = "Arquivo"
		Checked      = 0
		Enabled      = -1
		Separator    = 0
		Tag          = ""
		Visible      = -1
		BEGIN Menu bntSair
			Caption      = "Sai&r"
			Checked      = 0
			Enabled      = -1
			Separator    = 0
			Tag          = ""
			Visible      = -1
		END
	END
END
DECLARE SUB Misturar ()
DECLARE SUB Trocar (IndcA AS INTEGER, IndcB AS INTEGER)
DIM SHARED Letra(15) AS STRING
DIM SHARED Ganhou  AS INTEGER
DIM SHARED Contar  AS INTEGER

SUB bntSair_Click ()
   
     END

END SUB

SUB Botao_Click (Index AS INTEGER)

DIM Indice AS INTEGER

Indice = Index

' movimenta para a Direita
IF Indice < 15 AND Indice >= 0 THEN
  IF Botao(Indice + 1).Caption = " " THEN
      Contar = Contar + 1
      Trocar Indice, Indice + 1
  END IF
END IF

 
' Movimenta para a esquerda
IF Indice <= 15 AND Indice > 0 THEN
    IF Botao(Indice - 1).Caption = " " THEN
        Contar = Contar + 1
        Trocar Indice, Indice - 1
    END IF
END IF
  

' Novimenta para Baixo
IF Indice <= 11 AND Indice >= 0 THEN
    IF Botao(Indice + 4).Caption = " " THEN
        Contar = Contar + 1
        Trocar Indice, Indice + 4
    END IF
END IF

'Movimenta para c ima
IF Indice <= 15 AND Indice >= 4 THEN
    IF Botao(Indice - 4).Caption = " " THEN
        Contar = Contar + 1
        Trocar Indice, Indice - 4
    END IF
END IF

' atualiza clicks
Ltotck.Caption = STR$(Contar)


Ganhou = 1
y = 65
FOR x = 0 TO 14
  IF Botao(x).Caption = CHR$(y) THEN
    Botao(x).ForeColor = 5
  ELSE
    Botao(x).ForeColor = 0
    Ganhou = 0
  END IF
y = y + 1
NEXT x
 
IF Ganhou = 1 THEN
    MSGBOX "Voce Completou com " + STR$(Contar) + " Clicks.", 0, "Puzzle"
    btmMistura.Enabled = 1
END IF

END SUB

SUB btmMistura_Click ()
    btmMistura.Enabled = 0
    Misturar
END SUB

SUB Form_Load ()
   'aqui inicializo o jogo
y = 65
FOR x = 0 TO 14
  Letra(x) = CHR$(y)
  Botao(x).ForeColor = 5
  y = y + 1
NEXT x
Letra(15) = " "

btmMistura.Enabled = 0
Misturar

END SUB

SUB Ltotck_DblClick ()
     btmMistura.Enabled = 1
    Contar = 0


y = 65
FOR x = 0 TO 14
  IF Botao(x).Caption = CHR$(y) THEN
    Botao(x).ForeColor = 5
  ELSE
    Botao(x).ForeColor = 0
  END IF
y = y + 1
NEXT x


    Ltotck.Caption = STR$(Contar)

END SUB

SUB Misturar ()

DIM IndcA AS INTEGER
DIM IndcB AS INTEGER

Contar = 0
Ltotck.Caption = STR$(Contar)

     RANDOMIZE

      FOR x = 1 TO 50
        IndcA = INT(16 * RND)
        IndcB = INT(16 * RND)
        IF IndcA = IndcB THEN
            IndcB = INT(16 * RND)
        END IF
      Trocar IndcA, IndcB
      NEXT x

y = 65
FOR x = 0 TO 14
  IF Botao(x).Caption = CHR$(y) THEN
    Botao(x).ForeColor = 5
  ELSE
    Botao(x).ForeColor = 0
  END IF
y = y + 1
NEXT x

END SUB

SUB Trocar (IndcA AS INTEGER, IndcB AS INTEGER)
           
 DIM Letra  AS STRING

 IF Botao(IndcA).Caption = " " THEN
    Botao(IndcA).Borderstyle = 2
    Botao(IndcB).Borderstyle = 1
 ELSE
    IF Botao(IndcB).Caption = " " THEN
       Botao(IndcB).Borderstyle = 2
       Botao(IndcA).Borderstyle = 1
     END IF
 END IF
 
 Letra = Botao(IndcA).Caption
 Botao(IndcA).Caption = Botao(IndcB).Caption
 Botao(IndcB).Caption = Letra
END SUB

